<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Architecture and Methodology &mdash; LORE_sa  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Tabular explanations example" href="examples/tabular_explanations_example.html" />
    <link rel="prev" title="Get Started" href="get_started.html" />
    <link href="_static/style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            LORE_sa
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="get_started.html">Get started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="get_started.html#welcome-to-lore-sa">Welcome to LORE_sa</a></li>
<li class="toctree-l2"><a class="reference internal" href="get_started.html#what-is-lore">What is LORE?</a></li>
<li class="toctree-l2"><a class="reference internal" href="get_started.html#installation">Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="get_started.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="get_started.html#using-virtualenv">Using virtualenv</a></li>
<li class="toctree-l3"><a class="reference internal" href="get_started.html#using-conda">Using conda</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="get_started.html#quick-start">Quick Start</a><ul>
<li class="toctree-l3"><a class="reference internal" href="get_started.html#basic-usage">Basic Usage</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="get_started.html#key-components">Key Components</a></li>
<li class="toctree-l2"><a class="reference internal" href="get_started.html#choosing-an-explainer">Choosing an Explainer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="get_started.html#tabularrandomgeneratorlore">TabularRandomGeneratorLore</a></li>
<li class="toctree-l3"><a class="reference internal" href="get_started.html#tabulargeneticgeneratorlore">TabularGeneticGeneratorLore</a></li>
<li class="toctree-l3"><a class="reference internal" href="get_started.html#tabularrandgengeneratorlore">TabularRandGenGeneratorLore</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="get_started.html#understanding-the-explanation">Understanding the Explanation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="get_started.html#rule">Rule</a></li>
<li class="toctree-l3"><a class="reference internal" href="get_started.html#counterfactuals">Counterfactuals</a></li>
<li class="toctree-l3"><a class="reference internal" href="get_started.html#deltas">Deltas</a></li>
<li class="toctree-l3"><a class="reference internal" href="get_started.html#feature-importances">Feature Importances</a></li>
<li class="toctree-l3"><a class="reference internal" href="get_started.html#fidelity">Fidelity</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="get_started.html#next-steps">Next Steps</a></li>
<li class="toctree-l2"><a class="reference internal" href="get_started.html#common-pitfalls">Common Pitfalls</a></li>
<li class="toctree-l2"><a class="reference internal" href="get_started.html#getting-help">Getting Help</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Architecture and Methodology</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#theoretical-foundation">Theoretical Foundation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-four-stage-process">The Four-Stage Process</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#stage-1-instance-encoding">Stage 1: Instance Encoding</a></li>
<li class="toctree-l3"><a class="reference internal" href="#stage-2-neighborhood-generation">Stage 2: Neighborhood Generation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#stage-3-surrogate-training">Stage 3: Surrogate Training</a></li>
<li class="toctree-l3"><a class="reference internal" href="#stage-4-rule-extraction">Stage 4: Rule Extraction</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#architecture-components">Architecture Components</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#black-box-wrapper-abstractbbox">Black Box Wrapper (AbstractBBox)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataset-tabulardataset">Dataset (TabularDataset)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#encoder-decoder-encdec">Encoder/Decoder (EncDec)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#neighborhood-generator-neighborhoodgenerator">Neighborhood Generator (NeighborhoodGenerator)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#surrogate-model-surrogate">Surrogate Model (Surrogate)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rule-and-expression-classes">Rule and Expression Classes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#workflow-diagram">Workflow Diagram</a></li>
<li class="toctree-l2"><a class="reference internal" href="#best-practices">Best Practices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#choosing-num-instances">Choosing num_instances</a></li>
<li class="toctree-l3"><a class="reference internal" href="#interpreting-fidelity">Interpreting Fidelity</a></li>
<li class="toctree-l3"><a class="reference internal" href="#handling-low-fidelity">Handling Low Fidelity</a></li>
<li class="toctree-l3"><a class="reference internal" href="#feature-importance-interpretation">Feature Importance Interpretation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#computational-complexity">Computational Complexity</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#time-complexity">Time Complexity</a></li>
<li class="toctree-l3"><a class="reference internal" href="#space-complexity">Space Complexity</a></li>
<li class="toctree-l3"><a class="reference internal" href="#typical-running-times">Typical Running Times</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#references">References</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#primary-paper">Primary Paper</a></li>
<li class="toctree-l3"><a class="reference internal" href="#related-work">Related Work</a></li>
<li class="toctree-l3"><a class="reference internal" href="#key-differences-from-lime">Key Differences from LIME</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#implementation-notes">Implementation Notes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#thread-safety">Thread Safety</a></li>
<li class="toctree-l3"><a class="reference internal" href="#memory-considerations">Memory Considerations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reproducibility">Reproducibility</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#future-extensions">Future Extensions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples/tabular_explanations_example.html">Tabular explanation example</a><ul>
<li class="toctree-l2"><a class="reference internal" href="examples/tabular_explanations_example.html#learning-and-explaining-german-credit-dataset">Learning and explaining German Credit Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/tabular_explanations_example.html#loading-and-preparation-of-data">Loading and preparation of data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="examples/tabular_explanations_example.html#learning-a-random-forest-classfier">Learning a Random Forest classfier</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="examples/tabular_explanations_example.html#explaining-the-prediction">Explaining the prediction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="examples/tabular_explanations_example.html#shap-explainer">SHAP explainer</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/tabular_explanations_example.html#lore-explainer">LORE explainer</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/tabular_explanations_example.html#lime-explainer">LIME explainer</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="examples/tabular_explanations_example.html#learning-a-different-model">Learning a different model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="examples/tabular_explanations_example.html#learning-a-logistic-regressor">Learning a Logistic Regressor</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="examples/tabular_explanations_example.html#id1">Explaining the prediction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="examples/tabular_explanations_example.html#id2">LORE explainer</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/tabular_explanations_example.html#id3">LIME explainer</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="source/modules.html">Modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="source/modules.html#lore-sa-bbox-blackbox-abstract-class"><code class="xref py py-mod docutils literal notranslate"><span class="pre">lore_sa.bbox</span></code>: BlackBox abstract class</a><ul>
<li class="toctree-l3"><a class="reference internal" href="source/generated/lore_sa.bbox.AbstractBBox.html">lore_sa.bbox.AbstractBBox</a><ul>
<li class="toctree-l4"><a class="reference internal" href="source/generated/lore_sa.bbox.AbstractBBox.html#lore_sa.bbox.AbstractBBox"><code class="docutils literal notranslate"><span class="pre">AbstractBBox</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="source/modules.html#lore-sa-dataset-dataset-class"><code class="xref py py-mod docutils literal notranslate"><span class="pre">lore_sa.dataset</span></code>: Dataset class</a><ul>
<li class="toctree-l3"><a class="reference internal" href="source/generated/lore_sa.dataset.Dataset.html">lore_sa.dataset.Dataset</a><ul>
<li class="toctree-l4"><a class="reference internal" href="source/generated/lore_sa.dataset.Dataset.html#lore_sa.dataset.Dataset"><code class="docutils literal notranslate"><span class="pre">Dataset</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="source/generated/lore_sa.dataset.TabularDataset.html">lore_sa.dataset.TabularDataset</a><ul>
<li class="toctree-l4"><a class="reference internal" href="source/generated/lore_sa.dataset.TabularDataset.html#lore_sa.dataset.TabularDataset"><code class="docutils literal notranslate"><span class="pre">TabularDataset</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="source/generated/lore_sa.dataset.utils.html">lore_sa.dataset.utils</a><ul>
<li class="toctree-l4"><a class="reference internal" href="source/generated/lore_sa.dataset.utils.html#lore_sa.dataset.utils.prepare_bank_dataset"><code class="docutils literal notranslate"><span class="pre">prepare_bank_dataset()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="source/modules.html#lore-sa-neighgen-neighborhood-generator-classes"><code class="xref py py-mod docutils literal notranslate"><span class="pre">lore_sa.neighgen</span></code>: Neighborhood Generator classes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="source/generated/lore_sa.neighgen.RandomGenerator.html">lore_sa.neighgen.RandomGenerator</a><ul>
<li class="toctree-l4"><a class="reference internal" href="source/generated/lore_sa.neighgen.RandomGenerator.html#lore_sa.neighgen.RandomGenerator"><code class="docutils literal notranslate"><span class="pre">RandomGenerator</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="source/generated/lore_sa.neighgen.GeneticGenerator.html">lore_sa.neighgen.GeneticGenerator</a><ul>
<li class="toctree-l4"><a class="reference internal" href="source/generated/lore_sa.neighgen.GeneticGenerator.html#lore_sa.neighgen.GeneticGenerator"><code class="docutils literal notranslate"><span class="pre">GeneticGenerator</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="source/modules.html#lore-sa-discretizer-discretizer-classes-and-functions"><code class="xref py py-mod docutils literal notranslate"><span class="pre">lore_sa.discretizer</span></code>: Discretizer classes and functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="source/generated/lore_sa.discretizer.Discretizer.html">lore_sa.discretizer.Discretizer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="source/generated/lore_sa.discretizer.Discretizer.html#lore_sa.discretizer.Discretizer"><code class="docutils literal notranslate"><span class="pre">Discretizer</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="source/generated/lore_sa.discretizer.RMEPDiscretizer.html">lore_sa.discretizer.RMEPDiscretizer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="source/generated/lore_sa.discretizer.RMEPDiscretizer.html#lore_sa.discretizer.RMEPDiscretizer"><code class="docutils literal notranslate"><span class="pre">RMEPDiscretizer</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="source/modules.html#lore-sa-encoder-decoder-encoder-decoder-classes-and-functions"><code class="xref py py-mod docutils literal notranslate"><span class="pre">lore_sa.encoder_decoder</span></code>: Encoder/Decoder classes and functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="source/generated/lore_sa.encoder_decoder.EncDec.html">lore_sa.encoder_decoder.EncDec</a><ul>
<li class="toctree-l4"><a class="reference internal" href="source/generated/lore_sa.encoder_decoder.EncDec.html#lore_sa.encoder_decoder.EncDec"><code class="docutils literal notranslate"><span class="pre">EncDec</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="source/generated/lore_sa.encoder_decoder.ColumnTransformerEnc.html">lore_sa.encoder_decoder.ColumnTransformerEnc</a><ul>
<li class="toctree-l4"><a class="reference internal" href="source/generated/lore_sa.encoder_decoder.ColumnTransformerEnc.html#lore_sa.encoder_decoder.ColumnTransformerEnc"><code class="docutils literal notranslate"><span class="pre">ColumnTransformerEnc</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="source/modules.html#lore-sa-explanation-explanation-classes-and-functions"><code class="xref py py-mod docutils literal notranslate"><span class="pre">lore_sa.explanation</span></code>: Explanation classes and functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="source/generated/lore_sa.explanation.Explanation.html">lore_sa.explanation.Explanation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="source/generated/lore_sa.explanation.Explanation.html#lore_sa.explanation.Explanation"><code class="docutils literal notranslate"><span class="pre">Explanation</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="source/generated/lore_sa.explanation.ExplanationEncoder.html">lore_sa.explanation.ExplanationEncoder</a><ul>
<li class="toctree-l4"><a class="reference internal" href="source/generated/lore_sa.explanation.ExplanationEncoder.html#lore_sa.explanation.ExplanationEncoder"><code class="docutils literal notranslate"><span class="pre">ExplanationEncoder</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="source/generated/lore_sa.explanation.ImageExplanation.html">lore_sa.explanation.ImageExplanation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="source/generated/lore_sa.explanation.ImageExplanation.html#lore_sa.explanation.ImageExplanation"><code class="docutils literal notranslate"><span class="pre">ImageExplanation</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="source/generated/lore_sa.explanation.MultilabelExplanation.html">lore_sa.explanation.MultilabelExplanation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="source/generated/lore_sa.explanation.MultilabelExplanation.html#lore_sa.explanation.MultilabelExplanation"><code class="docutils literal notranslate"><span class="pre">MultilabelExplanation</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="source/generated/lore_sa.explanation.TextExplanation.html">lore_sa.explanation.TextExplanation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="source/generated/lore_sa.explanation.TextExplanation.html#lore_sa.explanation.TextExplanation"><code class="docutils literal notranslate"><span class="pre">TextExplanation</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="source/generated/lore_sa.explanation.json2explanation.html">lore_sa.explanation.json2explanation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="source/generated/lore_sa.explanation.json2explanation.html#lore_sa.explanation.json2explanation"><code class="docutils literal notranslate"><span class="pre">json2explanation()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="source/modules.html#lore-sa-rule-rule-classes-and-functions"><code class="xref py py-mod docutils literal notranslate"><span class="pre">lore_sa.rule</span></code>: Rule classes and functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="source/generated/lore_sa.rule.Rule.html">lore_sa.rule.Rule</a><ul>
<li class="toctree-l4"><a class="reference internal" href="source/generated/lore_sa.rule.Rule.html#lore_sa.rule.Rule"><code class="docutils literal notranslate"><span class="pre">Rule</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="source/generated/lore_sa.rule.RuleEncoder.html">lore_sa.rule.RuleEncoder</a><ul>
<li class="toctree-l4"><a class="reference internal" href="source/generated/lore_sa.rule.RuleEncoder.html#lore_sa.rule.RuleEncoder"><code class="docutils literal notranslate"><span class="pre">RuleEncoder</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="source/generated/lore_sa.rule.json2rule.html">lore_sa.rule.json2rule</a><ul>
<li class="toctree-l4"><a class="reference internal" href="source/generated/lore_sa.rule.json2rule.html#lore_sa.rule.json2rule"><code class="docutils literal notranslate"><span class="pre">json2rule()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="source/generated/lore_sa.rule.json2expression.html">lore_sa.rule.json2expression</a><ul>
<li class="toctree-l4"><a class="reference internal" href="source/generated/lore_sa.rule.json2expression.html#lore_sa.rule.json2expression"><code class="docutils literal notranslate"><span class="pre">json2expression()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="source/generated/lore_sa.rule.Expression.html">lore_sa.rule.Expression</a><ul>
<li class="toctree-l4"><a class="reference internal" href="source/generated/lore_sa.rule.Expression.html#lore_sa.rule.Expression"><code class="docutils literal notranslate"><span class="pre">Expression</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="source/modules.html#lore-sa-surrogate-surrogate-classes-and-functions"><code class="xref py py-mod docutils literal notranslate"><span class="pre">lore_sa.surrogate</span></code>: Surrogate classes and functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="source/generated/lore_sa.surrogate.Surrogate.html">lore_sa.surrogate.Surrogate</a><ul>
<li class="toctree-l4"><a class="reference internal" href="source/generated/lore_sa.surrogate.Surrogate.html#lore_sa.surrogate.Surrogate"><code class="docutils literal notranslate"><span class="pre">Surrogate</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="source/generated/lore_sa.surrogate.DecisionTreeSurrogate.html">lore_sa.surrogate.DecisionTreeSurrogate</a><ul>
<li class="toctree-l4"><a class="reference internal" href="source/generated/lore_sa.surrogate.DecisionTreeSurrogate.html#lore_sa.surrogate.DecisionTreeSurrogate"><code class="docutils literal notranslate"><span class="pre">DecisionTreeSurrogate</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="source/modules.html#lore-sa-util-util-functions"><code class="xref py py-mod docutils literal notranslate"><span class="pre">lore_sa.util</span></code>: Util functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="source/generated/lore_sa.util.html">lore_sa.util</a><ul>
<li class="toctree-l4"><a class="reference internal" href="source/generated/lore_sa.util.html#lore_sa.util.best_fit_distribution"><code class="docutils literal notranslate"><span class="pre">best_fit_distribution()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="source/generated/lore_sa.util.html#lore_sa.util.sigmoid"><code class="docutils literal notranslate"><span class="pre">sigmoid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="source/generated/lore_sa.util.html#lore_sa.util.vector2dict"><code class="docutils literal notranslate"><span class="pre">vector2dict()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">LORE_sa</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Architecture and Methodology</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/architecture.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="architecture-and-methodology">
<h1>Architecture and Methodology<a class="headerlink" href="#architecture-and-methodology" title="Permalink to this heading"></a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this heading"></a></h2>
<p>LORE (LOcal Rule-based Explanations) is a model-agnostic explanation framework designed to provide
interpretable explanations for black box classifier predictions. This document describes the
architecture, methodology, and theoretical foundation of LORE.</p>
</section>
<section id="theoretical-foundation">
<h2>Theoretical Foundation<a class="headerlink" href="#theoretical-foundation" title="Permalink to this heading"></a></h2>
<p>LORE is based on the following principles:</p>
<ol class="arabic simple">
<li><p><strong>Local Approximation</strong>: Rather than explaining the entire model, LORE explains individual predictions by creating a local approximation around the instance of interest.</p></li>
<li><p><strong>Rule-Based Explanations</strong>: Uses decision rules (IF-THEN statements) that are naturally interpretable to humans.</p></li>
<li><p><strong>Counterfactual Reasoning</strong>: Provides “what-if” scenarios showing what changes would lead to different predictions.</p></li>
<li><p><strong>Model Agnostic</strong>: Works with any black box classifier that provides a prediction interface.</p></li>
</ol>
</section>
<section id="the-four-stage-process">
<h2>The Four-Stage Process<a class="headerlink" href="#the-four-stage-process" title="Permalink to this heading"></a></h2>
<p>LORE follows a four-stage process to generate explanations:</p>
<section id="stage-1-instance-encoding">
<h3>Stage 1: Instance Encoding<a class="headerlink" href="#stage-1-instance-encoding" title="Permalink to this heading"></a></h3>
<p>The instance to explain is transformed from its original feature space to an encoded space suitable
for machine learning operations.</p>
<p><strong>Purpose:</strong>
- Handle categorical features through one-hot encoding
- Normalize numerical features if needed
- Create a consistent representation for the neighborhood generation</p>
<p><strong>Components:</strong>
- <code class="docutils literal notranslate"><span class="pre">EncDec</span></code>: Abstract encoder/decoder interface
- <code class="docutils literal notranslate"><span class="pre">ColumnTransformerEnc</span></code>: Concrete implementation for tabular data</p>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Original instance: [&#39;red&#39;, 30, 50000]</span>
<span class="c1"># Encoded instance:  [1, 0, 0, 30, 50000]  (one-hot for color)</span>

<span class="n">encoded_instance</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">encode</span><span class="p">([</span><span class="n">instance</span><span class="p">])</span>
</pre></div>
</div>
</section>
<section id="stage-2-neighborhood-generation">
<h3>Stage 2: Neighborhood Generation<a class="headerlink" href="#stage-2-neighborhood-generation" title="Permalink to this heading"></a></h3>
<p>A synthetic neighborhood of instances is generated around the encoded instance. This neighborhood
serves as training data for the surrogate model.</p>
<p><strong>Purpose:</strong>
- Explore the local decision boundary
- Generate instances with diverse predicted classes
- Create a representative sample of the local feature space</p>
<p><strong>Strategies:</strong></p>
<ol class="arabic simple">
<li><p><strong>Random Generation</strong> (<code class="docutils literal notranslate"><span class="pre">RandomGenerator</span></code>):</p>
<ul class="simple">
<li><p>Samples feature values uniformly from valid ranges</p></li>
<li><p>Fast but may miss important decision boundaries</p></li>
<li><p>Best for simple, well-behaved decision spaces</p></li>
</ul>
</li>
<li><p><strong>Genetic Algorithm</strong> (<code class="docutils literal notranslate"><span class="pre">GeneticGenerator</span></code>):</p>
<ul class="simple">
<li><p>Evolves a population of instances using genetic operators</p></li>
<li><p>Optimizes for: (1) similarity to original instance, (2) diversity in predictions</p></li>
<li><p>Provides better coverage of decision boundaries</p></li>
<li><p>Recommended for most use cases</p></li>
</ul>
</li>
<li><p><strong>Probabilistic Genetic</strong> (<code class="docutils literal notranslate"><span class="pre">GeneticProbaGenerator</span></code>):</p>
<ul class="simple">
<li><p>Adds probabilistic elements to genetic evolution</p></li>
<li><p>Balance between diversity and computational cost</p></li>
</ul>
</li>
</ol>
<p><strong>Key Parameters:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">num_instances</span></code>: Number of synthetic instances (default: 1000)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ocr</span></code> (One-Class Ratio): Balance between same-class and different-class instances (default: 0.1)</p></li>
</ul>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate 1000 synthetic instances around the encoded instance</span>
<span class="n">neighborhood</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
    <span class="n">encoded_instance</span><span class="p">,</span>
    <span class="n">num_instances</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
    <span class="n">descriptor</span><span class="o">=</span><span class="n">dataset</span><span class="o">.</span><span class="n">descriptor</span><span class="p">,</span>
    <span class="n">encoder</span><span class="o">=</span><span class="n">encoder</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="stage-3-surrogate-training">
<h3>Stage 3: Surrogate Training<a class="headerlink" href="#stage-3-surrogate-training" title="Permalink to this heading"></a></h3>
<p>An interpretable surrogate model (typically a decision tree) is trained on the neighborhood,
using predictions from the black box as labels.</p>
<p><strong>Purpose:</strong>
- Create a local approximation of the black box
- Provide an interpretable structure for rule extraction
- Measure fidelity (agreement with black box)</p>
<p><strong>Process:</strong></p>
<ol class="arabic simple">
<li><p>Generate predictions for all neighborhood instances using the black box</p></li>
<li><p>Train a decision tree on (neighborhood, predictions) pairs</p></li>
<li><p>Optionally prune the tree to improve interpretability</p></li>
<li><p>Compute fidelity score</p></li>
</ol>
<p><strong>Fidelity:</strong></p>
<p>Fidelity measures how well the surrogate approximates the black box in the local neighborhood:</p>
<div class="math notranslate nohighlight">
\[\begin{split}fidelity = \\frac{\\text{agreements}}{\\text{total instances}}\end{split}\]</div>
<p>A fidelity score close to 1.0 indicates high reliability of the explanation.</p>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get black box predictions for neighborhood</span>
<span class="n">bbox_predictions</span> <span class="o">=</span> <span class="n">bbox</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">decoded_neighborhood</span><span class="p">)</span>

<span class="c1"># Train decision tree surrogate</span>
<span class="n">surrogate</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">neighborhood</span><span class="p">,</span> <span class="n">bbox_predictions</span><span class="p">)</span>

<span class="c1"># Check fidelity</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fidelity: </span><span class="si">{</span><span class="n">surrogate</span><span class="o">.</span><span class="n">fidelity</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="stage-4-rule-extraction">
<h3>Stage 4: Rule Extraction<a class="headerlink" href="#stage-4-rule-extraction" title="Permalink to this heading"></a></h3>
<p>Decision rules are extracted from the trained surrogate to provide the explanation.</p>
<p><strong>Factual Rule:</strong></p>
<p>Describes the path in the decision tree that the instance follows, explaining why the
black box made its prediction.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>IF age &gt; 30 AND income &lt;= 50000 AND education = &#39;Bachelor&#39;
THEN prediction = &#39;denied&#39;
</pre></div>
</div>
<p><strong>Counterfactual Rules:</strong></p>
<p>Describe alternative paths in the tree leading to different predictions, showing what
changes would alter the outcome.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>IF age &gt; 30 AND income &gt; 50000
THEN prediction = &#39;approved&#39;
</pre></div>
</div>
<p><strong>Deltas (Minimal Changes):</strong></p>
<p>For each counterfactual, LORE computes the minimal set of feature changes needed:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>To change from &#39;denied&#39; to &#39;approved&#39;:
- Change: income from 45000 to &gt; 50000
- Keep: age = 35 (unchanged)
- Keep: education = &#39;Bachelor&#39; (unchanged)
</pre></div>
</div>
</section>
</section>
<section id="architecture-components">
<h2>Architecture Components<a class="headerlink" href="#architecture-components" title="Permalink to this heading"></a></h2>
<section id="black-box-wrapper-abstractbbox">
<h3>Black Box Wrapper (AbstractBBox)<a class="headerlink" href="#black-box-wrapper-abstractbbox" title="Permalink to this heading"></a></h3>
<p><strong>Purpose:</strong> Provides a consistent interface to any machine learning model.</p>
<p><strong>Requirements:</strong>
- <code class="docutils literal notranslate"><span class="pre">predict(X)</span></code>: Returns class predictions
- <code class="docutils literal notranslate"><span class="pre">predict_proba(X)</span></code>: Returns class probabilities</p>
<p><strong>Implementations:</strong>
- <code class="docutils literal notranslate"><span class="pre">sklearnBBox</span></code>: For scikit-learn models
- <code class="docutils literal notranslate"><span class="pre">KerasClassifierWrapper</span></code>: For Keras/TensorFlow models
- Custom wrappers can be created by inheriting from <code class="docutils literal notranslate"><span class="pre">AbstractBBox</span></code></p>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">lore_sa.bbox</span> <span class="kn">import</span> <span class="n">sklearn_classifier_bbox</span>

<span class="c1"># Wrap a scikit-learn pipeline</span>
<span class="n">bbox</span> <span class="o">=</span> <span class="n">sklearn_classifier_bbox</span><span class="o">.</span><span class="n">sklearnBBox</span><span class="p">(</span><span class="n">sklearn_pipeline</span><span class="p">)</span>

<span class="c1"># Now it has a consistent interface</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">bbox</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">probabilities</span> <span class="o">=</span> <span class="n">bbox</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="dataset-tabulardataset">
<h3>Dataset (TabularDataset)<a class="headerlink" href="#dataset-tabulardataset" title="Permalink to this heading"></a></h3>
<p><strong>Purpose:</strong> Stores data and metadata about features (types, ranges, categories).</p>
<p><strong>Descriptor Structure:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">descriptor</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;numeric&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;age&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">18</span><span class="p">,</span>
            <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mi">90</span><span class="p">,</span>
            <span class="s1">&#39;mean&#39;</span><span class="p">:</span> <span class="mf">45.2</span><span class="p">,</span>
            <span class="s1">&#39;std&#39;</span><span class="p">:</span> <span class="mf">12.5</span><span class="p">,</span>
            <span class="s1">&#39;median&#39;</span><span class="p">:</span> <span class="mi">44</span><span class="p">,</span>
            <span class="s1">&#39;q1&#39;</span><span class="p">:</span> <span class="mi">35</span><span class="p">,</span>
            <span class="s1">&#39;q3&#39;</span><span class="p">:</span> <span class="mi">55</span>
        <span class="p">},</span>
        <span class="s1">&#39;income&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
    <span class="p">},</span>
    <span class="s1">&#39;categorical&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;education&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;distinct_values&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;High School&#39;</span><span class="p">,</span> <span class="s1">&#39;Bachelor&#39;</span><span class="p">,</span> <span class="s1">&#39;Master&#39;</span><span class="p">,</span> <span class="s1">&#39;PhD&#39;</span><span class="p">],</span>
            <span class="s1">&#39;value_counts&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Bachelor&#39;</span><span class="p">:</span> <span class="mi">450</span><span class="p">,</span> <span class="s1">&#39;Master&#39;</span><span class="p">:</span> <span class="mi">300</span><span class="p">,</span> <span class="o">...</span><span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s1">&#39;ordinal&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Methods:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">from_csv()</span></code>: Load dataset from CSV file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">update_descriptor()</span></code>: Recompute feature statistics</p></li>
<li><p>Access via <code class="docutils literal notranslate"><span class="pre">dataset.df</span></code> (pandas DataFrame)</p></li>
</ul>
</section>
<section id="encoder-decoder-encdec">
<h3>Encoder/Decoder (EncDec)<a class="headerlink" href="#encoder-decoder-encdec" title="Permalink to this heading"></a></h3>
<p><strong>Purpose:</strong> Transform features between original and encoded spaces.</p>
<p><strong>Key Operations:</strong></p>
<ol class="arabic simple">
<li><p><strong>Encoding</strong>: Original → Encoded</p>
<ul class="simple">
<li><p>One-hot encode categorical features</p></li>
<li><p>Keep numerical features as-is (or scale if needed)</p></li>
</ul>
</li>
<li><p><strong>Decoding</strong>: Encoded → Original</p>
<ul class="simple">
<li><p>Reverse one-hot encoding for categorical features</p></li>
<li><p>Map back to original feature space</p></li>
</ul>
</li>
<li><p><strong>Feature Mapping</strong>:</p>
<ul class="simple">
<li><p>Track which encoded indices correspond to which original features</p></li>
<li><p>Maintain intervals for grouped features (e.g., one-hot encoded categories)</p></li>
</ul>
</li>
</ol>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Original: [30, &#39;red&#39;, 50000]</span>
<span class="n">encoded</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">encode</span><span class="p">([[</span><span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="mi">50000</span><span class="p">]])</span>
<span class="c1"># Result: [[30, 1, 0, 0, 50000]]  (one-hot for &#39;red&#39;)</span>

<span class="n">decoded</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">encoded</span><span class="p">)</span>
<span class="c1"># Result: [[30, &#39;red&#39;, 50000]]  (back to original)</span>

<span class="c1"># Get feature mapping</span>
<span class="n">features</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">get_encoded_features</span><span class="p">()</span>
<span class="c1"># {0: &#39;age&#39;, 1: &#39;color=red&#39;, 2: &#39;color=blue&#39;,</span>
<span class="c1">#  3: &#39;color=green&#39;, 4: &#39;income&#39;}</span>
</pre></div>
</div>
</section>
<section id="neighborhood-generator-neighborhoodgenerator">
<h3>Neighborhood Generator (NeighborhoodGenerator)<a class="headerlink" href="#neighborhood-generator-neighborhoodgenerator" title="Permalink to this heading"></a></h3>
<p><strong>Purpose:</strong> Generate synthetic instances for surrogate training.</p>
<p><strong>Parameters:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">bbox</span></code>: Black box to query for predictions</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dataset</span></code>: Dataset with feature descriptors</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">encoder</span></code>: Encoder for feature transformations</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ocr</span></code>: One-Class Ratio (balance between same/different class instances)</p></li>
</ul>
<p><strong>Genetic Algorithm Details:</strong></p>
<p>For <code class="docutils literal notranslate"><span class="pre">GeneticGenerator</span></code>, the genetic algorithm uses:</p>
<ul class="simple">
<li><p><strong>Fitness Functions</strong>:</p>
<ul>
<li><p>For same-class instances: Maximize similarity to original + same class prediction</p></li>
<li><p>For different-class instances: Maximize similarity + different class prediction</p></li>
</ul>
</li>
<li><p><strong>Genetic Operators</strong>:</p>
<ul>
<li><p><strong>Crossover</strong>: Combine features from two parent instances</p></li>
<li><p><strong>Mutation</strong>: Randomly change feature values</p></li>
<li><p><strong>Selection</strong>: Tournament selection based on fitness</p></li>
</ul>
</li>
<li><p><strong>Parameters</strong>:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">ngen</span></code>: Number of generations (default: 100)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mutpb</span></code>: Mutation probability (default: 0.2)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cxpb</span></code>: Crossover probability (default: 0.5)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">alpha1</span></code>, <code class="docutils literal notranslate"><span class="pre">alpha2</span></code>: Weights for similarity vs. diversity (default: 0.5, 0.5)</p></li>
</ul>
</li>
</ul>
</section>
<section id="surrogate-model-surrogate">
<h3>Surrogate Model (Surrogate)<a class="headerlink" href="#surrogate-model-surrogate" title="Permalink to this heading"></a></h3>
<p><strong>Purpose:</strong> Interpretable model that approximates black box locally.</p>
<p><strong>Decision Tree Surrogate:</strong></p>
<p>The <code class="docutils literal notranslate"><span class="pre">DecisionTreeSurrogate</span></code> uses scikit-learn’s DecisionTreeClassifier with:</p>
<ul class="simple">
<li><p><strong>Class balancing</strong>: <code class="docutils literal notranslate"><span class="pre">class_weight='balanced'</span></code> to handle imbalanced neighborhoods</p></li>
<li><p><strong>Optional pruning</strong>: Grid search to find optimal tree complexity</p></li>
<li><p><strong>Random state</strong>: Fixed for reproducibility</p></li>
</ul>
<p><strong>Pruning Parameters</strong> (when enabled):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">param_list</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;min_samples_split&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="s1">&#39;min_samples_leaf&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
    <span class="s1">&#39;splitter&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="s1">&#39;random&#39;</span><span class="p">],</span>
    <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
    <span class="s1">&#39;criterion&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;entropy&#39;</span><span class="p">,</span> <span class="s1">&#39;gini&#39;</span><span class="p">],</span>
    <span class="s1">&#39;max_features&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="s1">&#39;sqrt&#39;</span><span class="p">,</span> <span class="s1">&#39;log2&#39;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="rule-and-expression-classes">
<h3>Rule and Expression Classes<a class="headerlink" href="#rule-and-expression-classes" title="Permalink to this heading"></a></h3>
<p><strong>Expression</strong>: Single condition in a rule</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Represents: age &gt; 30</span>
<span class="n">expr</span> <span class="o">=</span> <span class="n">Expression</span><span class="p">(</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">gt</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Rule</strong>: Complete IF-THEN statement</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># IF age &gt; 30 AND income &lt;= 50000 THEN class = 0</span>
<span class="n">premises</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">Expression</span><span class="p">(</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">gt</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span>
    <span class="n">Expression</span><span class="p">(</span><span class="s1">&#39;income&#39;</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">le</span><span class="p">,</span> <span class="mi">50000</span><span class="p">)</span>
<span class="p">]</span>
<span class="n">consequence</span> <span class="o">=</span> <span class="n">Expression</span><span class="p">(</span><span class="s1">&#39;class&#39;</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">eq</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">rule</span> <span class="o">=</span> <span class="n">Rule</span><span class="p">(</span><span class="n">premises</span><span class="p">,</span> <span class="n">consequence</span><span class="p">,</span> <span class="n">encoder</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="workflow-diagram">
<h2>Workflow Diagram<a class="headerlink" href="#workflow-diagram" title="Permalink to this heading"></a></h2>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>┌─────────────────────────────────────────────────────────────┐
│ 1. Instance to Explain                                      │
│    [age=35, color=&#39;red&#39;, income=45000]                     │
└─────────────────┬───────────────────────────────────────────┘
                  │
                  ▼
┌─────────────────────────────────────────────────────────────┐
│ 2. Encoding                                                 │
│    [35, 1, 0, 0, 45000]  (one-hot for color)              │
└─────────────────┬───────────────────────────────────────────┘
                  │
                  ▼
┌─────────────────────────────────────────────────────────────┐
│ 3. Neighborhood Generation                                  │
│    1000 synthetic instances around encoded instance         │
│    - 900 with same predicted class                         │
│    - 100 with different predicted classes                  │
└─────────────────┬───────────────────────────────────────────┘
                  │
                  ▼
┌─────────────────────────────────────────────────────────────┐
│ 4. Black Box Labeling                                       │
│    Get predictions for all neighborhood instances           │
└─────────────────┬───────────────────────────────────────────┘
                  │
                  ▼
┌─────────────────────────────────────────────────────────────┐
│ 5. Surrogate Training                                       │
│    Train decision tree on (neighborhood, predictions)       │
│    Compute fidelity score                                   │
└─────────────────┬───────────────────────────────────────────┘
                  │
                  ▼
┌─────────────────────────────────────────────────────────────┐
│ 6. Rule Extraction                                          │
│    • Factual: Why this prediction?                         │
│    • Counterfactuals: What if scenarios?                   │
│    • Deltas: Minimal changes needed                        │
│    • Feature Importances: Which features matter most?      │
└─────────────────┬───────────────────────────────────────────┘
                  │
                  ▼
┌─────────────────────────────────────────────────────────────┐
│ 7. Explanation Output                                       │
│    Interpretable rules in original feature space           │
└─────────────────────────────────────────────────────────────┘
</pre></div>
</div>
</section>
<section id="best-practices">
<h2>Best Practices<a class="headerlink" href="#best-practices" title="Permalink to this heading"></a></h2>
<section id="choosing-num-instances">
<h3>Choosing num_instances<a class="headerlink" href="#choosing-num-instances" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p><strong>Small datasets (&lt;1000 instances)</strong>: 500-1000 synthetic instances</p></li>
<li><p><strong>Medium datasets (1000-10000)</strong>: 1000-2000 synthetic instances</p></li>
<li><p><strong>Large datasets (&gt;10000)</strong>: 1500-3000 synthetic instances</p></li>
</ul>
<p>More instances improve explanation quality but increase computation time.</p>
</section>
<section id="interpreting-fidelity">
<h3>Interpreting Fidelity<a class="headerlink" href="#interpreting-fidelity" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p><strong>fidelity &gt; 0.9</strong>: Excellent - explanation is highly reliable</p></li>
<li><p><strong>0.7 &lt; fidelity ≤ 0.9</strong>: Good - explanation is generally reliable</p></li>
<li><p><strong>0.5 &lt; fidelity ≤ 0.7</strong>: Fair - some uncertainty in explanation</p></li>
<li><p><strong>fidelity ≤ 0.5</strong>: Poor - explanation may not be reliable, increase num_instances</p></li>
</ul>
</section>
<section id="handling-low-fidelity">
<h3>Handling Low Fidelity<a class="headerlink" href="#handling-low-fidelity" title="Permalink to this heading"></a></h3>
<p>If fidelity is low, try:</p>
<ol class="arabic simple">
<li><p>Increase <code class="docutils literal notranslate"><span class="pre">num_instances</span></code> (e.g., from 1000 to 2000)</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">GeneticGenerator</span></code> instead of <code class="docutils literal notranslate"><span class="pre">RandomGenerator</span></code></p></li>
<li><p>Enable tree pruning in <code class="docutils literal notranslate"><span class="pre">DecisionTreeSurrogate</span></code></p></li>
<li><p>Check if the instance is an outlier or near a complex decision boundary</p></li>
</ol>
</section>
<section id="feature-importance-interpretation">
<h3>Feature Importance Interpretation<a class="headerlink" href="#feature-importance-interpretation" title="Permalink to this heading"></a></h3>
<p>Feature importances are computed from the decision tree’s feature importances, adjusted
for one-hot encoded features. Higher values indicate greater importance in the decision.</p>
<p><strong>Note</strong>: Importances are local to the specific instance and may differ from global
feature importances.</p>
</section>
</section>
<section id="computational-complexity">
<h2>Computational Complexity<a class="headerlink" href="#computational-complexity" title="Permalink to this heading"></a></h2>
<section id="time-complexity">
<h3>Time Complexity<a class="headerlink" href="#time-complexity" title="Permalink to this heading"></a></h3>
<p>For a single explanation:</p>
<ul class="simple">
<li><p><strong>Random Generation</strong>: O(n × f) where n = num_instances, f = num_features</p></li>
<li><p><strong>Genetic Generation</strong>: O(g × p × f × t) where g = generations, p = population size,
f = num_features, t = tree depth</p></li>
<li><p><strong>Surrogate Training</strong>: O(n × f × log(n)) for decision tree</p></li>
</ul>
</section>
<section id="space-complexity">
<h3>Space Complexity<a class="headerlink" href="#space-complexity" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p><strong>Neighborhood</strong>: O(n × f_enc) where f_enc = number of encoded features</p></li>
<li><p><strong>Decision Tree</strong>: O(nodes) where nodes depends on tree depth and complexity</p></li>
</ul>
</section>
<section id="typical-running-times">
<h3>Typical Running Times<a class="headerlink" href="#typical-running-times" title="Permalink to this heading"></a></h3>
<p>On a modern CPU (e.g., Intel i7):</p>
<ul class="simple">
<li><p><strong>RandomGenerator</strong>: 1-2 seconds per instance</p></li>
<li><p><strong>GeneticGenerator</strong>: 5-15 seconds per instance</p></li>
<li><p><strong>Explanation extraction</strong>: &lt;1 second</p></li>
</ul>
</section>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this heading"></a></h2>
<section id="primary-paper">
<h3>Primary Paper<a class="headerlink" href="#primary-paper" title="Permalink to this heading"></a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Guidotti, R., Monreale, A., Ruggieri, S., Pedreschi, D., Turini, F., &amp; Giannotti, F. (2018).
Local rule-based explanations of black box decision systems.
arXiv preprint arXiv:1805.10820.
https://arxiv.org/abs/1805.10820
</pre></div>
</div>
</section>
<section id="related-work">
<h3>Related Work<a class="headerlink" href="#related-work" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p>LIME (Local Interpretable Model-agnostic Explanations)</p></li>
<li><p>SHAP (SHapley Additive exPlanations)</p></li>
<li><p>Counterfactual Explanations</p></li>
<li><p>Rule-based Machine Learning</p></li>
</ul>
</section>
<section id="key-differences-from-lime">
<h3>Key Differences from LIME<a class="headerlink" href="#key-differences-from-lime" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p><strong>Rules vs Linear</strong>: LORE uses rules (IF-THEN), LIME uses linear models</p></li>
<li><p><strong>Counterfactuals</strong>: LORE provides explicit counterfactual scenarios</p></li>
<li><p><strong>Deltas</strong>: LORE computes minimal changes needed for different predictions</p></li>
<li><p><strong>Neighborhood</strong>: LORE uses genetic algorithms for better neighborhoods</p></li>
</ul>
</section>
</section>
<section id="implementation-notes">
<h2>Implementation Notes<a class="headerlink" href="#implementation-notes" title="Permalink to this heading"></a></h2>
<section id="thread-safety">
<h3>Thread Safety<a class="headerlink" href="#thread-safety" title="Permalink to this heading"></a></h3>
<p>The LORE implementation is not thread-safe. Create separate explainer instances for
concurrent explanations.</p>
</section>
<section id="memory-considerations">
<h3>Memory Considerations<a class="headerlink" href="#memory-considerations" title="Permalink to this heading"></a></h3>
<p>Large neighborhoods can consume significant memory. For memory-constrained environments:</p>
<ul class="simple">
<li><p>Reduce <code class="docutils literal notranslate"><span class="pre">num_instances</span></code></p></li>
<li><p>Process instances in batches</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">RandomGenerator</span></code> instead of <code class="docutils literal notranslate"><span class="pre">GeneticGenerator</span></code></p></li>
</ul>
</section>
<section id="reproducibility">
<h3>Reproducibility<a class="headerlink" href="#reproducibility" title="Permalink to this heading"></a></h3>
<p>For reproducible explanations:</p>
<ul class="simple">
<li><p>Set <code class="docutils literal notranslate"><span class="pre">random_seed</span></code> parameter in generators</p></li>
<li><p>Use fixed <code class="docutils literal notranslate"><span class="pre">random_state</span></code> in decision trees</p></li>
<li><p>Ensure consistent data preprocessing</p></li>
</ul>
</section>
</section>
<section id="future-extensions">
<h2>Future Extensions<a class="headerlink" href="#future-extensions" title="Permalink to this heading"></a></h2>
<p>Potential enhancements for LORE:</p>
<ol class="arabic simple">
<li><p><strong>Parallel Processing</strong>: Parallelize neighborhood generation and surrogate training</p></li>
<li><p><strong>Alternative Surrogates</strong>: Support for other interpretable models (rule lists, linear models)</p></li>
<li><p><strong>Image/Text Data</strong>: Extend beyond tabular data</p></li>
<li><p><strong>Constraint Handling</strong>: Better support for immutable features and domain constraints</p></li>
<li><p><strong>Interactive Exploration</strong>: Tools for exploring counterfactuals interactively</p></li>
</ol>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="get_started.html" class="btn btn-neutral float-left" title="Get Started" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="examples/tabular_explanations_example.html" class="btn btn-neutral float-right" title="Tabular explanations example" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Kode srl.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>